local lp = game.Players.LocalPlayer
local mouse = lp:GetMouse()
local camera = workspace.CurrentCamera
local rs = game:GetService("RunService")

-- UI Paneli
local ScreenGui = Instance.new("ScreenGui")
local Main = Instance.new("Frame")
local AimBtn = Instance.new("TextButton")

ScreenGui.Parent = game:GetService("CoreGui")
Main.Size = UDim2.new(0, 160, 0, 60)
Main.Position = UDim2.new(0.5, -80, 0.05, 0) -- Ekranın üst ortasında durur
Main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Main.Active = true
Main.Draggable = true

AimBtn.Parent = Main
AimBtn.Size = UDim2.new(0.9, 0, 0.8, 0)
AimBtn.Position = UDim2.new(0.05, 0, 0.1, 0)
AimBtn.Text = "EVRENSEL AIM: KAPALI"
AimBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
AimBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
AimBtn.Font = Enum.Font.SourceSansBold
AimBtn.TextSize = 14

local active = false
AimBtn.MouseButton1Click:Connect(function()
    active = not active
    AimBtn.Text = active and "EVRENSEL AIM: AÇIK" or "EVRENSEL AIM: KAPALI"
    AimBtn.BackgroundColor3 = active and Color3.fromRGB(0, 180, 0) or Color3.fromRGB(50, 50, 50)
end)

-- En Yakın Oyuncuyu Bulma (Evrensel)
local function getClosestPlayer()
    local closest = nil
    local dist = math.huge
    for _, v in pairs(game.Players:GetPlayers()) do
        if v ~= lp and v.Character and v.Character:FindFirstChild("HumanoidRootPart") and v.Character:FindFirstChild("Humanoid") and v.Character.Humanoid.Health > 0 then
            local pos, onScreen = camera:WorldToViewportPoint(v.Character.HumanoidRootPart.Position)
            if onScreen then
                local magnitude = (Vector2.new(pos.X, pos.Y) - Vector2.new(mouse.X, mouse.Y)).Magnitude
                if magnitude < dist then
                    closest = v.Character.HumanoidRootPart
                    dist = magnitude
                end
            end
        end
    end
    return closest
end

-- Takip Döngüsü
rs.RenderStepped:Connect(function()
    if active then
        local target = getClosestPlayer()
        if target then
            -- Kamerayı hedefe pürüzsüzce çevirir
            camera.CFrame = CFrame.new(camera.CFrame.Position, target.Position)
        end
    end
end)
